jQuery(document).ready(function(a){a(".resizer li").on("click",function(){var b=a(this).attr("id");"f_s"==b?a(".post-content").stop(!1,!0).animate({"font-size":"-=1px","line-height":"-=1px"},"fast"):"f_l"==b?a(".post-content").stop(!1,!0).animate({"font-size":"+=1px","line-height":"+=1px"},"fast"):"f_m"==b&&a(".post-content").animate({"font-size":"14px"},"fast").removeAttr("style")}),a(".toggle_content").hide(),a(".toggle_title").on("click",function(){return a(this).toggleClass("toggle_active").next().slideToggle("fast"),!1}),a(".bymt-tabs .tabs-title a").on("click",function(b){b.preventDefault(),a(this).parents("li").addClass("tabon").siblings("li.tabon").removeClass("tabon");var c=a(this).parents("li").index();return a(this).parents(".bymt-tabs").find(".tabs-content").eq(c).show().siblings(".tabs-content").hide(),!1}),a(".reply").live("click",function(){var b='"#'+a(this).parent().parent().parent().attr("id")+'"',c=a(this).parent().find(".commentid").text();a("#comment").val("<a href="+b+">@"+c+"</a> ").focus()}),a("#cancel-comment-reply-link").live("click",function(){a("#comment").val("")}),a(function(){commat_hover=function(){a(".comment_text a").hover(function(){var c=a(this).attr("href").substr(1),d=a("#div-"+c).html(),e=a("#div-"+c).height();return null==e?!1:(a(this).before('<div id="insert_at"></div>'),a(this).parent().parent().css("position","relative"),a("#insert_at").stop(!0,!0).css({top:-(e+10)+"px"}).html(d).fadeIn(),void 0)},function(){a("#insert_at").remove()})},commat_hover()}),a("#edit-author").length>0&&(a("#author-info").hide(),a("#edit-author").live("click",function(){"none"==a("#author-info").css("display")?a(this).text("[\u53d6\u6d88]"):a(this).text("[\u7f16\u8f91]"),a("#author-info,#real-avatar").stop(!1,!0).slideToggle()})),a(document).keypress(function(b){b.ctrlKey&&13==b.which||10==b.which?(a("#submit").click(),document.body.focus()):(b.shiftKey&&13==b.which||10==b.which)&&a("#submit").click()}),a("#welcome strong").hover(function(){var b=a("#real-avatar").html();a("#avatar-img").html(b),a(".user-avatar").stop(!1,!0).fadeIn(300)},function(){a(".user-avatar").stop(!1,!0).fadeOut(800)});var b=a("#comment_post_ID").val(),c=a("#comment_home_url").val(),d=1;if(a("#email").live("blur",function(){var b=a(this).val();return 0==d?!1:(d=0,a.ajax({url:c,type:"POST",data:"action=bymt_ajax_avatar&email="+b,beforeSend:function(){a("#real-avatar").html('<img src="'+c+'/wp-content/themes/BYMT/images/loading.gif" style="padding:13px;" alt=""/>')},success:function(b){a("#real-avatar").html(b),setTimeout(function(){d=1},3e3)}}),void 0)}),a.fn.addvalue=function(b){var c=a(this)[0];if(document.selection)this.focus(),sel=document.selection.createRange(),sel.text=b,this.focus();else if(c.selectionStart||"0"==c.selectionStart){var d=c.selectionStart,e=c.selectionEnd,f=c.scrollTop;c.value=c.value.substring(0,d)+b+c.value.substring(e,c.value.length),this.focus(),c.selectionStart=d+b.length,c.selectionEnd=d+b.length,c.scrollTop=f}else this.value+=b,this.focus()},0==a("#comment-tools ul >li").size()&&(a("#comment-tools").css("border","0"),a("#comment").css("border-radius","3px")),a("#smilies-box li").on("click",function(){a("#comment").addvalue(a(this).children("img").data("value"))}),a("#add-code-ok a").on("click",function(){var b=a("#add-codelang-s").val(),c=a("#add-codelang-i").val(),d=a("#add-codetext").val();codelang=""!=c?c:b,""==d?(a("#add-code-ok small").css("color","red").text("\u8bf7\u5148\u8d34\u5165\u4ee3\u7801"),a("#add-codetext").focus()):(a("li#tools-code").removeClass("tools-on"),a("#add-code").slideUp(),a("#add-codetext").val(""),a("#add-code-ok small").removeAttr("style").text("\u65e0\u9700\u5bf9\u4ee3\u7801\u8fdb\u884c\u8f6c\u4e49\uff0c\u7a0b\u5e8f\u4f1a\u81ea\u52a8\u8f6c\u4e49"),a("#comment").addvalue('<pre lang="'+codelang+'">\n'+d+"\n</pre>\n"))}),a("#add-image-ok a").on("click",function(){var b=/((http|https|ftp):\/\/){1}(.*?)\.(.*?)\w+\.(jpg|png|gif)/i,c=a("#add-imgurl").val(),d=a("#add-imgalt").val(),e='<img src="'+c+'" alt="'+d+'" />';""==c?(a("#add-image-ok small").css("color","red").text("\u56fe\u7247\u5730\u5740\u4e0d\u80fd\u4e3a\u7a7a"),a("#add-imgurl").focus()):b.test(c)?(a("li#tools-image").removeClass("tools-on"),a("#add-image").slideUp(),a("#add-imgurl,#add-imgalt").val(""),a("#add-image-ok small").removeAttr("style").text("\u4ec5\u652f\u6301 .jpg .png .gif \u683c\u5f0f\u7684\u56fe\u7247"),a("#comment").addvalue(e)):(a("#add-image-ok small").css("color","red").text("\u4e0d\u652f\u6301\u8be5\u56fe\u7247\u5730\u5740"),a("#add-imgurl").focus())}),a("#comment").on("click",function(){a("#smilies-box,#add-image,#add-code").slideUp(),a("#tools-smilies,#tools-image,#tools-code").removeClass("tools-on")}),a("#comment-tools li").on("click",function(){var b=a(this),c=new Date,d=c.toLocaleTimeString(),e=a("#comment");switch(("tools-image"!=b.attr("id")||"tools-code"!=b.attr("id"))&&(a("#tools-image,#tools-code").removeClass("tools-on"),a("#add-image,#add-code").slideUp()),b.attr("id")){case"tools-smilies":b.toggleClass("tools-on"),a("#smilies-box").stop(!0,!1).slideToggle();break;case"tools-strong":e.addvalue("<strong>\u6587\u5b57</strong>");break;case"tools-em":e.addvalue("<em>\u6587\u5b57</em>");break;case"tools-underline":e.addvalue("<u>\u6587\u5b57</u>");break;case"tools-del":e.addvalue("<del>\u6587\u5b57</del>");break;case"tools-quote":e.addvalue("<blockquote>\u6587\u5b57</blockquote>");break;case"tools-image":b.toggleClass("tools-on"),a("#add-image").stop(!0,!1).slideToggle();break;case"tools-code":b.toggleClass("tools-on"),a("#add-code").stop(!0,!1).slideToggle();break;case"tools-come":e.addvalue("<blockquote>\u7b7e\u5230\u6210\u529f\uff01\u7b7e\u5230\u65f6\u95f4\uff1a"+d+"\u6bcf\u65e5\u6253\u5361\uff0c\u751f\u6d3b\u66f4\u7cbe\u5f69\u54e6~</blockquote>"),b.remove();break;case"tools-good":e.addvalue("<blockquote> :grin:  :grin: \u597d\u7f9e\u5c04\uff0c\u6587\u7ae0\u771f\u7684\u597d\u8d5e\u554a\uff0c\u9876\u535a\u4e3b\uff01</blockquote>"),b.remove();break;case"tools-bad":e.addvalue("<blockquote> :twisted:  :twisted: \u6709\u70b9\u770b\u4e0d\u61c2\u54e6\uff0c\u5e0c\u671b\u4e0b\u6b21\u5199\u7684\u7b80\u5355\u6613\u61c2\u4e00\u70b9\uff01</blockquote>"),b.remove();break;case"tools-admin":e.addvalue("[private]\u7ba1\u7406\u5458\u53ef\u89c1\u7684\u5185\u5bb9[/private]");break;default:return!1}}),0<a("#comment_form").length){var j,e=a("#comment_form"),f=c,g='<i class="icon-error"></i>',h='<div id="loading"><img src="'+(f+"/wp-content/themes/BYMT/images/loading.gif")+'" alt=""/> \u6b63\u5728\u63d0\u4ea4, \u8bf7\u7a0d\u5019...</div>',i='"><i class="icon-ok"></i> \u63d0\u4ea4\u6210\u529f',k=0,l=[],m=a("#cancel-comment-reply-link"),n=m.text(),o=a("#submit");o.attr("disabled",!1),$body=window.opera?"CSS1Compat"==document.compatMode?a("html"):a("body"):a("html,body"),a(".comment-btns").before(h+'<div id="error"></div>'),a("#loading").hide(),a("#error").hide(),a(".commentlist").length||a(".respond").before('<ol class="commentlist"></ol>'),e.submit(function(){return a("#comment").attr("readonly",!0),a("#loading").slideDown(),o.attr("disabled",!0).fadeTo("slow",.65),j&&a("#comment").after('<input type="text" name="edit_id" id="edit_id" value="'+j+'" style="display:none;" />'),a.ajax({url:f,data:a(this).serialize()+"&action=bymt_ajax_comment",type:"POST",error:function(b){a("#loading").slideUp(),a("#error").slideDown().html(g+b.responseText),setTimeout(function(){a("#comment").attr("readonly",!1),o.attr("disabled",!1).fadeTo("slow",1),a("#error").slideUp()},3e3)},success:function(b){a("#loading").hide(),a("#comment").attr("readonly",!1),l.push(a("#comment").val()),a("textarea").each(function(){this.value=""});var c=addComment,d=c.I("cancel-comment-reply-link"),e=c.I("wp-temp-form-div"),f=c.I(c.respondId);c.I("comment_post_ID");var g=c.I("comment_parent").value;new_htm='" id="new_comm_'+k+'"></',new_htm="0"==g?"<div "+new_htm+"div>":'\n<ul class="children'+new_htm+"ul>",ok_htm='\n<span id="success'+i,ok_htm+="</span>\n","0"==g?a(".commentlist").append(new_htm):a("#respond").before(new_htm),a("#new_comm_"+k).hide().append(b),a("#new_comm_"+k+" .comment-body").append(ok_htm),a("#new_comm_"+k).fadeIn(4e3),a("#comments-number").text(parseInt(a("#comments-number").text())+1),$body.animate({scrollTop:a("#new_comm_"+k).offset().top-200},900),s(),k++,j="",a("*").remove("#edit_id"),d.style.display="none",d.onclick=null,c.I("comment_parent").value="0",e&&f&&(e.parentNode.insertBefore(f,e),e.parentNode.removeChild(e))},complete:function(){code_highlight(),images_error(),mouse_title(),commat_hover()}}),!1}),addComment={moveForm:function(b,c,d,e,f){var b=this.I(b),g=this.I(d),h=this.I("cancel-comment-reply-link"),i=this.I("comment_parent"),k=this.I("comment_post_ID");j&&p(),0<l.length&&f?(this.I("comment").value=l[f],j=this.I("new_comm_"+f).innerHTML.match(/(comment-)(\d+)/)[2],$new_sucs=a("#success_"+f),$new_sucs.hide(),$new_comm=a("#new_comm_"+f),$new_comm.hide(),m.text("\u53d6\u6d88\u7f16\u8f91")):m.text(n),this.respondId=d,e=e||!1,this.I("wp-temp-form-div")||(d=document.createElement("div"),d.id="wp-temp-form-div",d.style.display="none",g.parentNode.insertBefore(d,g)),b?b.parentNode.insertBefore(g,b.nextSibling):(temp=this.I("wp-temp-form-div"),this.I("comment_parent").value="0",temp.parentNode.insertBefore(g,temp),temp.parentNode.removeChild(temp)),$body.animate({scrollTop:a("#respond").offset().top-180},400),k&&e&&(k.value=e),i.value=c,h.style.display="",h.onclick=function(){j&&p();var a=addComment,b=a.I("wp-temp-form-div"),c=a.I(a.respondId);return a.I("comment_parent").value="0",b&&c&&(b.parentNode.insertBefore(c,b),b.parentNode.removeChild(b)),this.style.display="none",this.onclick=null,!1};try{this.I("comment").focus()}catch(o){}return!1},I:function(a){return document.getElementById(a)}};var p=function(){$new_comm.show(),$new_sucs.show(),a("textarea").each(function(){this.value=""}),j=""},q=5,r=o.val(),s=function(){q>0?(o.val(q),q--,setTimeout(s,1e3)):(o.val(r).attr("disabled",!1).fadeTo("slow",1),q=5)}}if(a("#wrapper-inner").attr("data-bymts").indexOf("ajax-comment")>=0){var t=a(".commentshow"),u=b,v=c,w='<div id="ajax_loading"></div>';t.on("click",".pagination a",function(b){b.preventDefault();var b=a(this).attr("href"),c=1;/comment-page-/i.test(b)?c=b.split(/comment-page-/i)[1].split(/(\/|#|&).*$/)[0]:/cpage=/i.test(b)&&(c=b.split(/cpage=/)[1].split(/(\/|#|&).*$/)[0]),a.ajax({url:v+"?action=bymt_ajax_pagenavi&post="+u+"&page="+c,dataType:"html",beforeSend:function(){t.html(w),a("body").attr("class").indexOf("admin-bar")>=0?a("body, html").animate({scrollTop:t.offset().top-40},"slow"):a("body, html").animate({scrollTop:t.offset().top-12},"slow")},error:function(a){t.html(a.responseText)},success:function(a){t.html(a)},complete:function(){code_highlight(),images_error(),check_thumb(),auto_sidebar(),mouse_title(),commat_hover()}})})}});